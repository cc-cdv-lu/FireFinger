<div class="container">
  <h1>Settings</h1>
  <nav>
    <a routerLink="/levels">Levels</a>
    <a routerLink="/login">login</a>
    <a routerLink="/settings">Settings</a>
  </nav>
  <mat-accordion>
    <mat-expansion-panel>
      <mat-expansion-panel-header>
        <mat-panel-title>
          Chapter selection
        </mat-panel-title>
        <mat-panel-description>
          General settings for the whole application
        </mat-panel-description>
      </mat-expansion-panel-header>


      <section class="section" *ngFor="let set of allLessons">
        <h2>{{set.name}}</h2>
        <mat-grid-list cols="5">
          <mat-grid-tile *ngFor="let chapter of set.chapters; let i = index">
            <button mat-raised-button (click)="session.loadSession(set, i)">{{chapter.name}}</button>
          </mat-grid-tile>
        </mat-grid-list>
      </section>
    </mat-expansion-panel>



    <mat-expansion-panel>
      <mat-expansion-panel-header>
        <mat-panel-title>
          Style
        </mat-panel-title>
        <mat-panel-description>
          General settings for the whole application
        </mat-panel-description>
      </mat-expansion-panel-header>


      <section class="section">
        <h2>Change color scheme</h2>
        <mat-grid-list cols="5">
          <mat-grid-tile *ngFor="let c of style.colorSchemes">
            <button mat-raised-button (click)="style.setActiveColorScheme(c)" [style.color]="c.current" [style.backgroundColor]="c.backgroundColor" [style.border]="c == style.activeColorScheme ? '8px solid red' : '0px'">{{c.name}}</button>
          </mat-grid-tile>
        </mat-grid-list>
      </section>

      <section class="section">
        <h2>Font size</h2>
        <mat-slider thumbLabel tickInterval="1" [(ngModel)]="style.fontSize" min="50" max="1100" step="1"></mat-slider>
      </section>
    </mat-expansion-panel>

    <mat-expansion-panel>
      <mat-expansion-panel-header>
        <mat-panel-title>
          Application settings
        </mat-panel-title>
        <mat-panel-description>
          General settings for the whole application
        </mat-panel-description>
      </mat-expansion-panel-header>


      <section class="section">
        <h2>Text file location</h2>
        <mat-form-field>
          <input matInput matAutosize=true maxRows=1 placeholder="Path to chapter folders" [(ngModel)]="lessons.url" />
        </mat-form-field>
      </section>
    </mat-expansion-panel>


    <mat-expansion-panel>
      <mat-expansion-panel-header>
        <mat-panel-title>
          User Info
        </mat-panel-title>
        <mat-panel-description>
          General settings for the whole application
        </mat-panel-description>
      </mat-expansion-panel-header>

      <h1>Statistics</h1>
      <section class="section">
        <h2>Name</h2>
        <span>{{user.loggedInUser.name}}</span>
      </section>

      <section class="section">
        <h2>Last session stats</h2>
        <b>Typespeed:</b> {{getFormat(user.loggedInUser.lastSessionStats.typeSpeed)}}
        <b>Mistakes:</b>{{user.loggedInUser.lastSessionStats.mistakesCount}} ({{getFormat(user.loggedInUser.lastSessionStats.mistakePercentage)}} %)

        <h3>Most mistakes:</h3>
        <mat-grid-list cols="5">
          <mat-grid-tile *ngFor="let mistake of stats.getTopMistakes(user.loggedInUser.lastSessionStats, 10)">
            <b>{{mistake?.key}}:</b> {{mistake?.count}}
          </mat-grid-tile>
        </mat-grid-list>
      </section>

      <section class="section">
        <h2>Overall stats</h2>
        <b>Typespeed:</b> {{getFormat(user.loggedInUser.overallStats.typeSpeed)}}
        <b>Mistakes:</b>{{user.loggedInUser.overallStats.mistakesCount}} ({{getFormat(user.loggedInUser.overallStats.mistakePercentage)}} %)

        <h3>Most mistakes:</h3>
        <mat-grid-list cols="5">
          <mat-grid-tile *ngFor="let mistake of stats.getTopMistakes(user.loggedInUser.overallStats,10)">
            <b>{{mistake?.key}}:</b> {{mistake?.count}}
          </mat-grid-tile>
        </mat-grid-list>
      </section>
    </mat-expansion-panel>


  </mat-accordion>
</div>
